# Variability in tibia-fibular geometry is associated with increased tibial strain from running loads

*We recommend downloading a Markdown reader like [Typora](https://typora.io/) to view the readme files within this dataset.*

If using any code or data from this repository, please cite the associated paper:

Keast MF, Bonacci J, Fox AS (2023). Variability in tibia-fibular geometry is associated with increased tibial strain from running loads. *Royal Society Open Science*.

Please note that if using the shape model data contained in this repository, the associated paper for this work should also be cited:

Keast MF, Bonacci J, Fox AS (2023). Geometric variation of the human tibia-fibula: A public dataset of tibia-fibula surface meshes and statistical shape model. *Peer J*, 11: e14708. doi: https://doi.org/10.7717/peerj.14708

## Dependencies

A series of MATLAB dependencies are required to run the code associated with this dataset. Our code has been tested on MATLAB version 2019b. Certain code dependencies are included in the 'Code' or 'Supplementary' directories in various folders, and these are typically added to the MATLAB path at the beginning of the code. Other major dependencies include:

- [GIBBON](https://www.gibboncode.org/): used to prepare and analyse the 3D surface data
- [geom3d](https://au.mathworks.com/matlabcentral/fileexchange/24484-geom3d): used to simplify the process of applying 3D geometric calculations
- [export_fig](https://au.mathworks.com/matlabcentral/fileexchange/23629-export_fig): used to export high resolution figures from MATLAB
- [FEBio](https://febio.org/): used to run the finite element analysis simulations
- [GIBOC Knee Coordinate System](https://doi.org/10.1016/j.jbiomech.2018.08.028): Used to identify articulating surfaces. Note that this process has now been incorporated into the [MSK-STAPLE toolbox](https://github.com/modenaxe/msk-STAPLE)
- [OpenSim](https://opensim.stanford.edu/): used to extract the loads from the experimental running dataset.
- [MuscleForceDirection Plugin](https://simtk.org/projects/force_direction): used to extract the muscle force lines of actions from the experimental running dataset. Please cite the original paper at the linked SimTK page if using.
- [spm1d](https://spm1d.org/): used to run the linear regression statistical analyses on FEA outputs

## Code

The following points outline the functions and processes involved of the various scripts included with this analysis. The order of these dot points also corresponds to the general order in which these scripts were each run to generate and analyse the shape models.

- **runSimulations.m:** This script contains the required commands to run the finite element simulations using the surfaces generated from the shape model data. It is supported by the `easyRun.m` script which calls `runSimulations.m` script to process the multiple cases listed. Note that this particular step takes a decent amount of time to run. The other function called within this particular script is `setUpFEBioSim.m`.
- **compileSimulations.m:** This script pulls together the outputs from the simulations run using the `runSimulations.m` script and saves the data in an appropriate format to be analysed.
- **analyseSimulations.m:** This script takes the data compiled from the `compileSimulations.m` script to generate the relevant figures and run the statistical analyses.

This folder also contains a **Supplementary** directory which contains a range of relevant functions (mostly outlined in the dependencies above) which are used throughout the main scripts.

## Results

The **Results** folder contains the compiled and analysed outputs (inc. the generated figures and statistical outputs) from the FEA simulations. Reviewing the above-mentioned MATLAB scripts will highlight how these outputs were generated.

## Simulations

The **Simulations** folder contains the outputs from the FEA generated by the `runSimulations.m` script. The data within the individual case folders are used in the compiling and analyses functions.

## Other Resources

The below points provide a summary of the remaining folders which contain supporting resources that were used in this study:

- **GenericOpenSimModel:** The generic OpenSim model in this folder comes from [Lai et al. (2017)](https://simtk.org/projects/model-high-flex) and is used to map the attachment of muscles on the tibia to the surfaces used in finite element simulations.
- **HamnerDelp2013-RunningData:** This folder contains the running data originally collected and reported on by [Hamner & Delp (2013)](https://doi.org/10.1016/j.jbiomech.2012.11.024). Any use of these data should cite the original source.
- **Shape Models:** This folder contains the shape models originally created from the same dataset of segmented tibiae and fibulae. Any use of these models should cite the original [Keast et al. (2023)](https://doi.org/10.7717/peerj.14708) source.